(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('boardgame.io/dist/client'), require('react'), require('react-dom'), require('boardgame.io/dist/react'), require('uuid'), require('@angular/common'), require('ng-dynamic-component')) :
    typeof define === 'function' && define.amd ? define('boardgame.io-angular', ['exports', '@angular/core', 'boardgame.io/dist/client', 'react', 'react-dom', 'boardgame.io/dist/react', 'uuid', '@angular/common', 'ng-dynamic-component'], factory) :
    (factory((global.boardgame = global.boardgame || {}, global.boardgame['io-angular'] = {}),global.ng.core,null,null,null,null,null,global.ng.common,null));
}(this, (function (exports,core,client,React,ReactDOM,react,uuid,common,ngDynamicComponent) { 'use strict';

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var ClientComponent = (function () {
        function ClientComponent() {
            // instance inputs
            this.gameID = 'default';
            this.playerID = null;
            this.credentials = null;
            // overridable inputs (both class and instance)
            this.debug = true;
        }
        /**
         * @return {?}
         */
        ClientComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.client = client.Client({
                    game: this.game,
                    ai: this.ai,
                    numPlayers: this.numPlayers,
                    multiplayer: this.multiplayer,
                    gameID: this.gameID,
                    playerID: this.playerID,
                    credentials: this.credentials,
                    enhancer: this.enhancer,
                });
                // todo is this needed? (forceUpdate on react)
                // this.client.subscribe(() => {
                //   console.log('client.subscribe triggered (forceUpdate needed?)');
                // });
            };
        /**
         * @param {?} changes
         * @return {?}
         */
        ClientComponent.prototype.ngOnChanges = /**
         * @param {?} changes
         * @return {?}
         */
            function (changes) {
                if (this.client) {
                    // noinspection TsLint
                    if (changes["gameID"] && changes["gameID"].currentValue != changes["gameID"].previousValue) {
                        this.client.updateGameID(changes["gameID"].currentValue);
                    }
                    // noinspection TsLint
                    if (changes["playerID"] && changes["playerID"].currentValue != changes["playerID"].previousValue) {
                        this.client.updatePlayerID(changes["playerID"].currentValue);
                    }
                    // noinspection TsLint
                    if (changes["credentials"] && changes["credentials"].currentValue != changes["credentials"].previousValue) {
                        this.client.updateCredentials(changes["credentials"].currentValue);
                    }
                }
            };
        /**
         * @return {?}
         */
        ClientComponent.prototype.ngAfterContentInit = /**
         * @return {?}
         */
            function () {
                this.client.connect();
            };
        /**
         * @return {?}
         */
        ClientComponent.prototype.getBoardInputs = /**
         * @return {?}
         */
            function () {
                var /** @type {?} */ state = this.client.getState();
                return __assign({}, state, { isMultiplayer: this.multiplayer !== undefined, moves: this.client.moves, events: this.client.events, gameID: this.gameID, playerID: this.playerID, reset: this.client.reset, undo: this.client.undo, redo: this.client.redo });
            };
        ClientComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bio-client',
                        template: "\n    <ng-container *ngIf=\"client\">\n      <ng-container *ngComponentOutlet=\"board;\n                                            ndcDynamicInputs: getBoardInputs()\">\n      </ng-container>\n    </ng-container>\n\n    <bio-debug *ngIf=\"debug && client\"\n               [gamestate]=\"client.getState()\"\n               [gameID]=\"gameID\"\n               [playerID]=\"playerID\"\n               [isMultiplayer]=\"multiplayer !== undefined\"\n               [moves]=\"client.moves\"\n               [events]=\"client.events\"\n               [store]=\"client.store\"\n               [step]=\"client.step\"\n               [reset]=\"client.reset\"\n               [reducer]=\"client.reducer\"\n    ></bio-debug>\n  "
                    },] },
        ];
        ClientComponent.propDecorators = {
            game: [{ type: core.Input }],
            numPlayers: [{ type: core.Input }],
            board: [{ type: core.Input }],
            multiplayer: [{ type: core.Input }],
            ai: [{ type: core.Input }],
            enhancer: [{ type: core.Input }],
            gameID: [{ type: core.Input }],
            playerID: [{ type: core.Input }],
            credentials: [{ type: core.Input }],
            debug: [{ type: core.Input }]
        };
        return ClientComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var DebugComponent = (function () {
        function DebugComponent() {
        }
        /**
         * @return {?}
         */
        DebugComponent.prototype.getRootDomNode = /**
         * @return {?}
         */
            function () {
                return document.getElementById(this.rootDomID);
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.getProps = /**
         * @return {?}
         */
            function () {
                var _a = this, gamestate = _a.gamestate, gameID = _a.gameID, playerID = _a.playerID, isConnected = _a.isConnected, isMultiplayer = _a.isMultiplayer, moves = _a.moves, events = _a.events, restore = _a.restore, showLog = _a.showLog, store = _a.store, step = _a.step, reset = _a.reset, reducer = _a.reducer, overrideGameState = _a.overrideGameState, visualizeAI = _a.visualizeAI;
                return {
                    gamestate: gamestate,
                    gameID: gameID,
                    playerID: playerID,
                    isConnected: isConnected,
                    isMultiplayer: isMultiplayer,
                    moves: moves,
                    events: events,
                    restore: restore,
                    showLog: showLog,
                    store: store,
                    step: step,
                    reset: reset,
                    reducer: reducer,
                    overrideGameState: overrideGameState,
                    visualizeAI: visualizeAI,
                };
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.isMounted = /**
         * @return {?}
         */
            function () {
                return !!this.rootDomID;
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.render = /**
         * @return {?}
         */
            function () {
                if (this.isMounted()) {
                    ReactDOM.render(React.createElement(react.Debug, this.getProps()), this.getRootDomNode());
                }
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.ngOnInit = /**
         * @return {?}
         */
            function () {
                this.rootDomID = uuid.v1();
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.ngOnChanges = /**
         * @return {?}
         */
            function () {
                this.render();
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.ngAfterViewInit = /**
         * @return {?}
         */
            function () {
                this.render();
            };
        /**
         * @return {?}
         */
        DebugComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                ReactDOM.unmountComponentAtNode(this.getRootDomNode());
            };
        DebugComponent.decorators = [
            { type: core.Component, args: [{
                        selector: 'bio-debug',
                        template: '<span [id]="rootDomID"></span>'
                    },] },
        ];
        DebugComponent.propDecorators = {
            gamestate: [{ type: core.Input }],
            gameID: [{ type: core.Input }],
            playerID: [{ type: core.Input }],
            isConnected: [{ type: core.Input }],
            isMultiplayer: [{ type: core.Input }],
            moves: [{ type: core.Input }],
            events: [{ type: core.Input }],
            restore: [{ type: core.Input }],
            showLog: [{ type: core.Input }],
            store: [{ type: core.Input }],
            step: [{ type: core.Input }],
            reset: [{ type: core.Input }],
            reducer: [{ type: core.Input }],
            overrideGameState: [{ type: core.Input }],
            visualizeAI: [{ type: core.Input }]
        };
        return DebugComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */
    var BoardgameIoModule = (function () {
        function BoardgameIoModule() {
        }
        BoardgameIoModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [
                            common.CommonModule,
                            ngDynamicComponent.DynamicModule.withComponents(null),
                        ],
                        declarations: [ClientComponent, DebugComponent],
                        exports: [ClientComponent]
                    },] },
        ];
        return BoardgameIoModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes} checked by tsc
     */

    exports.ClientComponent = ClientComponent;
    exports.BoardgameIoModule = BoardgameIoModule;
    exports.ɵa = DebugComponent;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmRnYW1lLmlvLWFuZ3VsYXIudW1kLmpzLm1hcCIsInNvdXJjZXMiOltudWxsLCJuZzovL2JvYXJkZ2FtZS5pby1hbmd1bGFyL2xpYi9iaW8tY2xpZW50LmNvbXBvbmVudC50cyIsIm5nOi8vYm9hcmRnYW1lLmlvLWFuZ3VsYXIvbGliL2Jpby1kZWJ1Zy5jb21wb25lbnQudHMiLCJuZzovL2JvYXJkZ2FtZS5pby1hbmd1bGFyL2xpYi9ib2FyZGdhbWUtaW8ubW9kdWxlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgQWZ0ZXJDb250ZW50SW5pdCwgQ29tcG9uZW50LCBJbnB1dCwgT25DaGFuZ2VzLCBPbkluaXQsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQ2xpZW50IGFzIFJhd0NsaWVudCwgRGVidWcgfSBmcm9tICdib2FyZGdhbWUuaW8vZGlzdC9jbGllbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdiaW8tY2xpZW50JyxcclxuICB0ZW1wbGF0ZTogYFxyXG4gICAgPG5nLWNvbnRhaW5lciAqbmdJZj1cImNsaWVudFwiPlxyXG4gICAgICA8bmctY29udGFpbmVyICpuZ0NvbXBvbmVudE91dGxldD1cImJvYXJkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5kY0R5bmFtaWNJbnB1dHM6IGdldEJvYXJkSW5wdXRzKClcIj5cclxuICAgICAgPC9uZy1jb250YWluZXI+XHJcbiAgICA8L25nLWNvbnRhaW5lcj5cclxuXHJcbiAgICA8YmlvLWRlYnVnICpuZ0lmPVwiZGVidWcgJiYgY2xpZW50XCJcclxuICAgICAgICAgICAgICAgW2dhbWVzdGF0ZV09XCJjbGllbnQuZ2V0U3RhdGUoKVwiXHJcbiAgICAgICAgICAgICAgIFtnYW1lSURdPVwiZ2FtZUlEXCJcclxuICAgICAgICAgICAgICAgW3BsYXllcklEXT1cInBsYXllcklEXCJcclxuICAgICAgICAgICAgICAgW2lzTXVsdGlwbGF5ZXJdPVwibXVsdGlwbGF5ZXIgIT09IHVuZGVmaW5lZFwiXHJcbiAgICAgICAgICAgICAgIFttb3Zlc109XCJjbGllbnQubW92ZXNcIlxyXG4gICAgICAgICAgICAgICBbZXZlbnRzXT1cImNsaWVudC5ldmVudHNcIlxyXG4gICAgICAgICAgICAgICBbc3RvcmVdPVwiY2xpZW50LnN0b3JlXCJcclxuICAgICAgICAgICAgICAgW3N0ZXBdPVwiY2xpZW50LnN0ZXBcIlxyXG4gICAgICAgICAgICAgICBbcmVzZXRdPVwiY2xpZW50LnJlc2V0XCJcclxuICAgICAgICAgICAgICAgW3JlZHVjZXJdPVwiY2xpZW50LnJlZHVjZXJcIlxyXG4gICAgPjwvYmlvLWRlYnVnPlxyXG4gIGBcclxufSlcclxuZXhwb3J0IGNsYXNzIENsaWVudENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzLCBBZnRlckNvbnRlbnRJbml0IHtcclxuXHJcbiAgLy8gY2xhc3MgaW5wdXRzIChwb3NzaWJsZSBtb3ZlIHRvIGhpZ2hlciBsZXZlbCBpbml0aWFsaXphdGlvbiAoZS5nLiwgY2xhc3MgZmFjdG9yeSlcclxuICBASW5wdXQoKSBnYW1lOiBhbnk7XHJcbiAgQElucHV0KCkgbnVtUGxheWVyczogbnVtYmVyO1xyXG4gIEBJbnB1dCgpIGJvYXJkOiBhbnk7XHJcbiAgQElucHV0KCkgbXVsdGlwbGF5ZXI6IGFueTtcclxuICBASW5wdXQoKSBhaTogYW55O1xyXG4gIEBJbnB1dCgpIGVuaGFuY2VyOiBhbnk7XHJcblxyXG4gIC8vIGluc3RhbmNlIGlucHV0c1xyXG4gIEBJbnB1dCgpIGdhbWVJRCA9ICdkZWZhdWx0JztcclxuICBASW5wdXQoKSBwbGF5ZXJJRDogc3RyaW5nID0gbnVsbDtcclxuICBASW5wdXQoKSBjcmVkZW50aWFsczogc3RyaW5nID0gbnVsbDsgLy8gVE9ETyB0aGlzXHJcblxyXG4gIC8vIG92ZXJyaWRhYmxlIGlucHV0cyAoYm90aCBjbGFzcyBhbmQgaW5zdGFuY2UpXHJcbiAgQElucHV0KCkgZGVidWcgPSB0cnVlO1xyXG5cclxuICBjbGllbnQ6IGFueTtcclxuXHJcbiAgbmdPbkluaXQoKSB7XHJcbiAgICB0aGlzLmNsaWVudCA9IFJhd0NsaWVudCh7XHJcbiAgICAgIGdhbWU6IHRoaXMuZ2FtZSxcclxuICAgICAgYWk6IHRoaXMuYWksXHJcbiAgICAgIG51bVBsYXllcnM6IHRoaXMubnVtUGxheWVycyxcclxuICAgICAgbXVsdGlwbGF5ZXI6IHRoaXMubXVsdGlwbGF5ZXIsXHJcbiAgICAgIGdhbWVJRDogdGhpcy5nYW1lSUQsXHJcbiAgICAgIHBsYXllcklEOiB0aGlzLnBsYXllcklELFxyXG4gICAgICBjcmVkZW50aWFsczogdGhpcy5jcmVkZW50aWFscyxcclxuICAgICAgZW5oYW5jZXI6IHRoaXMuZW5oYW5jZXIsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyB0b2RvIGlzIHRoaXMgbmVlZGVkPyAoZm9yY2VVcGRhdGUgb24gcmVhY3QpXHJcbiAgICAvLyB0aGlzLmNsaWVudC5zdWJzY3JpYmUoKCkgPT4ge1xyXG4gICAgLy8gICBjb25zb2xlLmxvZygnY2xpZW50LnN1YnNjcmliZSB0cmlnZ2VyZWQgKGZvcmNlVXBkYXRlIG5lZWRlZD8pJyk7XHJcbiAgICAvLyB9KTtcclxuICB9XHJcblxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcclxuICAgIGlmICh0aGlzLmNsaWVudCkge1xyXG4gICAgICAvLyBub2luc3BlY3Rpb24gVHNMaW50XHJcbiAgICAgIGlmIChjaGFuZ2VzLmdhbWVJRCAmJiBjaGFuZ2VzLmdhbWVJRC5jdXJyZW50VmFsdWUgIT0gY2hhbmdlcy5nYW1lSUQucHJldmlvdXNWYWx1ZSkge1xyXG4gICAgICAgIHRoaXMuY2xpZW50LnVwZGF0ZUdhbWVJRChjaGFuZ2VzLmdhbWVJRC5jdXJyZW50VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIG5vaW5zcGVjdGlvbiBUc0xpbnRcclxuICAgICAgaWYgKGNoYW5nZXMucGxheWVySUQgJiYgY2hhbmdlcy5wbGF5ZXJJRC5jdXJyZW50VmFsdWUgIT0gY2hhbmdlcy5wbGF5ZXJJRC5wcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnQudXBkYXRlUGxheWVySUQoY2hhbmdlcy5wbGF5ZXJJRC5jdXJyZW50VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIG5vaW5zcGVjdGlvbiBUc0xpbnRcclxuICAgICAgaWYgKGNoYW5nZXMuY3JlZGVudGlhbHMgJiYgY2hhbmdlcy5jcmVkZW50aWFscy5jdXJyZW50VmFsdWUgIT0gY2hhbmdlcy5jcmVkZW50aWFscy5wcmV2aW91c1ZhbHVlKSB7XHJcbiAgICAgICAgdGhpcy5jbGllbnQudXBkYXRlQ3JlZGVudGlhbHMoY2hhbmdlcy5jcmVkZW50aWFscy5jdXJyZW50VmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ0FmdGVyQ29udGVudEluaXQoKSB7XHJcbiAgICB0aGlzLmNsaWVudC5jb25uZWN0KCk7XHJcbiAgfVxyXG5cclxuICBnZXRCb2FyZElucHV0cygpIHtcclxuICAgIGNvbnN0IHN0YXRlID0gdGhpcy5jbGllbnQuZ2V0U3RhdGUoKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIC4uLnN0YXRlLFxyXG4gICAgICBpc011bHRpcGxheWVyOiB0aGlzLm11bHRpcGxheWVyICE9PSB1bmRlZmluZWQsXHJcbiAgICAgIG1vdmVzOiB0aGlzLmNsaWVudC5tb3ZlcyxcclxuICAgICAgZXZlbnRzOiB0aGlzLmNsaWVudC5ldmVudHMsXHJcbiAgICAgIGdhbWVJRDogdGhpcy5nYW1lSUQsXHJcbiAgICAgIHBsYXllcklEOiB0aGlzLnBsYXllcklELFxyXG4gICAgICByZXNldDogdGhpcy5jbGllbnQucmVzZXQsXHJcbiAgICAgIHVuZG86IHRoaXMuY2xpZW50LnVuZG8sXHJcbiAgICAgIHJlZG86IHRoaXMuY2xpZW50LnJlZG8sXHJcbiAgICB9O1xyXG5cclxuICB9XHJcblxyXG59XHJcbiIsImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcclxuaW1wb3J0ICogYXMgUmVhY3RET00gZnJvbSAncmVhY3QtZG9tJztcclxuaW1wb3J0IHsgRGVidWcgfSBmcm9tICdib2FyZGdhbWUuaW8vZGlzdC9yZWFjdCc7XHJcbmltcG9ydCAqIGFzIHV1aWQgZnJvbSAndXVpZCc7XHJcblxyXG5pbXBvcnQgeyBBZnRlclZpZXdJbml0LCBDb21wb25lbnQsIElucHV0LCBPbkNoYW5nZXMsIE9uRGVzdHJveSwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEdhbWVTdGF0ZSB7XHJcbiAgRzogYW55O1xyXG4gIGN0eDogYW55O1xyXG4gIGxvZzogYW55O1xyXG4gIGlzQWN0aXZlPzogYm9vbGVhbjtcclxuICBfaW5pdGlhbDogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIERlYnVnUHJvcHMge1xyXG4gIGdhbWVzdGF0ZTogR2FtZVN0YXRlO1xyXG4gIGdhbWVJRDogc3RyaW5nO1xyXG4gIHBsYXllcklEPzogc3RyaW5nO1xyXG4gIGlzQ29ubmVjdGVkPzogYm9vbGVhbjtcclxuICBpc011bHRpcGxheWVyPzogYm9vbGVhbjtcclxuICBtb3Zlcz86IGFueTtcclxuICBldmVudHM/OiBhbnk7XHJcbiAgcmVzdG9yZT86IEZ1bmN0aW9uO1xyXG4gIHNob3dMb2c/OiBib29sZWFuO1xyXG4gIHN0b3JlPzogYW55O1xyXG4gIHN0ZXA/OiBGdW5jdGlvbjtcclxuICByZXNldD86IEZ1bmN0aW9uO1xyXG4gIHJlZHVjZXI/OiBGdW5jdGlvbjtcclxuICBvdmVycmlkZUdhbWVTdGF0ZT86IEZ1bmN0aW9uO1xyXG4gIHZpc3VhbGl6ZUFJPzogRnVuY3Rpb247XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnYmlvLWRlYnVnJyxcclxuICB0ZW1wbGF0ZTogJzxzcGFuIFtpZF09XCJyb290RG9tSURcIj48L3NwYW4+J1xyXG59KVxyXG5leHBvcnQgY2xhc3MgRGVidWdDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSwgT25DaGFuZ2VzLCBBZnRlclZpZXdJbml0IHtcclxuICBASW5wdXQoKSBnYW1lc3RhdGU6IEdhbWVTdGF0ZTtcclxuICBASW5wdXQoKSBnYW1lSUQ6IHN0cmluZztcclxuICBASW5wdXQoKSBwbGF5ZXJJRD86IHN0cmluZztcclxuICBASW5wdXQoKSBpc0Nvbm5lY3RlZD86IGJvb2xlYW47XHJcbiAgQElucHV0KCkgaXNNdWx0aXBsYXllcj86IGJvb2xlYW47XHJcbiAgQElucHV0KCkgbW92ZXM/OiBhbnk7XHJcbiAgQElucHV0KCkgZXZlbnRzPzogYW55O1xyXG4gIEBJbnB1dCgpIHJlc3RvcmU/OiBGdW5jdGlvbjtcclxuICBASW5wdXQoKSBzaG93TG9nPzogYm9vbGVhbjtcclxuICBASW5wdXQoKSBzdG9yZT86IGFueTtcclxuICBASW5wdXQoKSBzdGVwPzogRnVuY3Rpb247XHJcbiAgQElucHV0KCkgcmVzZXQ/OiBGdW5jdGlvbjtcclxuICBASW5wdXQoKSByZWR1Y2VyPzogRnVuY3Rpb247XHJcbiAgQElucHV0KCkgb3ZlcnJpZGVHYW1lU3RhdGU/OiBGdW5jdGlvbjtcclxuICBASW5wdXQoKSB2aXN1YWxpemVBST86IEZ1bmN0aW9uO1xyXG5cclxuICByb290RG9tSUQ6IHN0cmluZztcclxuXHJcbiAgcHJvdGVjdGVkIGdldFJvb3REb21Ob2RlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucm9vdERvbUlEKTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBnZXRQcm9wcygpOiBEZWJ1Z1Byb3BzIHtcclxuICAgIGNvbnN0IHtcclxuICAgICAgZ2FtZXN0YXRlLFxyXG4gICAgICBnYW1lSUQsXHJcbiAgICAgIHBsYXllcklELFxyXG4gICAgICBpc0Nvbm5lY3RlZCxcclxuICAgICAgaXNNdWx0aXBsYXllcixcclxuICAgICAgbW92ZXMsXHJcbiAgICAgIGV2ZW50cyxcclxuICAgICAgcmVzdG9yZSxcclxuICAgICAgc2hvd0xvZyxcclxuICAgICAgc3RvcmUsXHJcbiAgICAgIHN0ZXAsXHJcbiAgICAgIHJlc2V0LFxyXG4gICAgICByZWR1Y2VyLFxyXG4gICAgICBvdmVycmlkZUdhbWVTdGF0ZSxcclxuICAgICAgdmlzdWFsaXplQUksXHJcbiAgICB9ID0gdGhpcztcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGdhbWVzdGF0ZSxcclxuICAgICAgZ2FtZUlELFxyXG4gICAgICBwbGF5ZXJJRCxcclxuICAgICAgaXNDb25uZWN0ZWQsXHJcbiAgICAgIGlzTXVsdGlwbGF5ZXIsXHJcbiAgICAgIG1vdmVzLFxyXG4gICAgICBldmVudHMsXHJcbiAgICAgIHJlc3RvcmUsXHJcbiAgICAgIHNob3dMb2csXHJcbiAgICAgIHN0b3JlLFxyXG4gICAgICBzdGVwLFxyXG4gICAgICByZXNldCxcclxuICAgICAgcmVkdWNlcixcclxuICAgICAgb3ZlcnJpZGVHYW1lU3RhdGUsXHJcbiAgICAgIHZpc3VhbGl6ZUFJLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgaXNNb3VudGVkKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuICEhdGhpcy5yb290RG9tSUQ7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgcmVuZGVyKCkge1xyXG4gICAgaWYgKHRoaXMuaXNNb3VudGVkKCkpIHtcclxuICAgICAgUmVhY3RET00ucmVuZGVyKFxyXG4gICAgICAgIFJlYWN0LmNyZWF0ZUVsZW1lbnQoRGVidWcsIHRoaXMuZ2V0UHJvcHMoKSksXHJcbiAgICAgICAgdGhpcy5nZXRSb290RG9tTm9kZSgpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMucm9vdERvbUlEID0gdXVpZC52MSgpO1xyXG4gIH1cclxuXHJcbiAgbmdPbkNoYW5nZXMoKSB7XHJcbiAgICB0aGlzLnJlbmRlcigpO1xyXG4gIH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgdGhpcy5yZW5kZXIoKTtcclxuICB9XHJcblxyXG4gIG5nT25EZXN0cm95KCkge1xyXG4gICAgUmVhY3RET00udW5tb3VudENvbXBvbmVudEF0Tm9kZSh0aGlzLmdldFJvb3REb21Ob2RlKCkpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBOZ01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xyXG5pbXBvcnQgeyBDbGllbnRDb21wb25lbnQgfSBmcm9tICcuL2Jpby1jbGllbnQuY29tcG9uZW50JztcclxuaW1wb3J0IHsgQ29tbW9uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcclxuaW1wb3J0IHsgRHluYW1pY01vZHVsZSB9IGZyb20gJ25nLWR5bmFtaWMtY29tcG9uZW50JztcclxuaW1wb3J0IHsgRGVidWdDb21wb25lbnQgfSBmcm9tICcuL2Jpby1kZWJ1Zy5jb21wb25lbnQnO1xyXG5cclxuQE5nTW9kdWxlKHtcclxuICBpbXBvcnRzOiBbXHJcbiAgICBDb21tb25Nb2R1bGUsXHJcblxyXG4gICAgRHluYW1pY01vZHVsZS53aXRoQ29tcG9uZW50cyhudWxsKSxcclxuICBdLFxyXG4gIGRlY2xhcmF0aW9uczogW0NsaWVudENvbXBvbmVudCwgRGVidWdDb21wb25lbnRdLFxyXG4gIGV4cG9ydHM6IFtDbGllbnRDb21wb25lbnRdXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBCb2FyZGdhbWVJb01vZHVsZSB7IH1cclxuIl0sIm5hbWVzIjpbIlJhd0NsaWVudCIsIkNvbXBvbmVudCIsIklucHV0IiwiUmVhY3RET00ucmVuZGVyIiwiUmVhY3QuY3JlYXRlRWxlbWVudCIsIkRlYnVnIiwidXVpZC52MSIsIlJlYWN0RE9NLnVubW91bnRDb21wb25lbnRBdE5vZGUiLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSIsIkR5bmFtaWNNb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7OztJQUFBOzs7Ozs7Ozs7Ozs7OztBQWNBLElBZU8sSUFBSSxRQUFRLEdBQUc7UUFDbEIsUUFBUSxHQUFHLE1BQU0sQ0FBQyxNQUFNLElBQUksa0JBQWtCLENBQUM7WUFDM0MsS0FBSyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQ2pELENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pCLEtBQUssSUFBSSxDQUFDLElBQUksQ0FBQztvQkFBRSxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENB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